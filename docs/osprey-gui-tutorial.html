<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Osprey GUI tutorial | Osprey Documentation</title>
  <meta name="description" content="Osprey is an all-in-one software suite for state-of-the art processing and quantitative analysis of in-vivo magnetic resonance spectroscopy (MRS) data." />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Osprey GUI tutorial | Osprey Documentation" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Osprey is an all-in-one software suite for state-of-the art processing and quantitative analysis of in-vivo magnetic resonance spectroscopy (MRS) data." />
  <meta name="github-repo" content="schorschinho/osprey" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Osprey GUI tutorial | Osprey Documentation" />
  
  <meta name="twitter:description" content="Osprey is an all-in-one software suite for state-of-the art processing and quantitative analysis of in-vivo magnetic resonance spectroscopy (MRS) data." />
  

<meta name="author" content="Georg Oeltzschner" />


<meta name="date" content="2023-04-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-osprey-job-file.html"/>
<link rel="next" href="osprey-command-line-tutorial.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Osprey Documentation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Osprey</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contact-feedback-suggestions"><i class="fa fa-check"></i>Contact, Feedback, Suggestions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#developers"><i class="fa fa-check"></i>Developers</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="faqs.html"><a href="faqs.html"><i class="fa fa-check"></i><b>1</b> FAQs</a></li>
<li class="chapter" data-level="2" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>2</b> Getting started</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started.html"><a href="getting-started.html#system-requirements"><i class="fa fa-check"></i><b>2.1</b> System requirements</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started.html"><a href="getting-started.html#installing-osprey"><i class="fa fa-check"></i><b>2.2</b> Installing Osprey</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started.html"><a href="getting-started.html#how-to-organize-your-raw-data"><i class="fa fa-check"></i><b>2.3</b> How to organize your raw data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-osprey-workflow.html"><a href="the-osprey-workflow.html"><i class="fa fa-check"></i><b>3</b> The Osprey Workflow</a></li>
<li class="chapter" data-level="4" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html"><i class="fa fa-check"></i><b>4</b> The Osprey job file</a>
<ul>
<li class="chapter" data-level="4.1" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html#example-job-file"><i class="fa fa-check"></i><b>4.1</b> Example job file</a></li>
<li class="chapter" data-level="4.2" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html#specifying-sequence-information"><i class="fa fa-check"></i><b>4.2</b> Specifying Sequence Information</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html#sequence-type"><i class="fa fa-check"></i><b>4.2.1</b> Sequence Type</a></li>
<li class="chapter" data-level="4.2.2" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html#editing-targets"><i class="fa fa-check"></i><b>4.2.2</b> Editing Targets</a></li>
<li class="chapter" data-level="4.2.3" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html#data-scenario"><i class="fa fa-check"></i><b>4.2.3</b> Data Scenario</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html#data-handling-and-modeling-options"><i class="fa fa-check"></i><b>4.3</b> Data handling and modeling options</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html#spectral-registration-options"><i class="fa fa-check"></i><b>4.3.1</b> Spectral registration options</a></li>
<li class="chapter" data-level="4.3.2" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html#sub-spectral-alignment"><i class="fa fa-check"></i><b>4.3.2</b> Sub-spectral alignment</a></li>
<li class="chapter" data-level="4.3.3" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html#eddy-current-correction"><i class="fa fa-check"></i><b>4.3.3</b> Eddy-current correction</a></li>
<li class="chapter" data-level="4.3.4" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html#saving-data-to-external-formats"><i class="fa fa-check"></i><b>4.3.4</b> Saving data to external formats</a></li>
<li class="chapter" data-level="4.3.5" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html#matbolites-included-in-the-basis-set"><i class="fa fa-check"></i><b>4.3.5</b> Matbolites included in the basis-set</a></li>
<li class="chapter" data-level="4.3.6" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html#lcmodel-specific-options"><i class="fa fa-check"></i><b>4.3.6</b> LCModel-specific options</a></li>
<li class="chapter" data-level="4.3.7" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html#fit-style"><i class="fa fa-check"></i><b>4.3.7</b> Fit style</a></li>
<li class="chapter" data-level="4.3.8" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html#fitting-range"><i class="fa fa-check"></i><b>4.3.8</b> Fitting range</a></li>
<li class="chapter" data-level="4.3.9" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html#baseline-knot-spacing"><i class="fa fa-check"></i><b>4.3.9</b> Baseline knot spacing</a></li>
<li class="chapter" data-level="4.3.10" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html#macromolecule-and-lipid-signals"><i class="fa fa-check"></i><b>4.3.10</b> Macromolecule and lipid signals</a></li>
<li class="chapter" data-level="4.3.11" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html#co-edited-macrommolecules"><i class="fa fa-check"></i><b>4.3.11</b> Co-edited macrommolecules</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html#specifying-mrs-data-and-structural-imaging-files"><i class="fa fa-check"></i><b>4.4</b> Specifying MRS data and structural imaging files</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html#metabolite-data"><i class="fa fa-check"></i><b>4.4.1</b> Metabolite data</a></li>
<li class="chapter" data-level="4.4.2" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html#lineshape-reference-data"><i class="fa fa-check"></i><b>4.4.2</b> Lineshape reference data</a></li>
<li class="chapter" data-level="4.4.3" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html#short-te-water-data"><i class="fa fa-check"></i><b>4.4.3</b> Short-TE water data</a></li>
<li class="chapter" data-level="4.4.4" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html#structural-images"><i class="fa fa-check"></i><b>4.4.4</b> Structural images</a></li>
<li class="chapter" data-level="4.4.5" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html#specifying-stat-file"><i class="fa fa-check"></i><b>4.4.5</b> Specifying stat file</a></li>
<li class="chapter" data-level="4.4.6" data-path="the-osprey-job-file.html"><a href="the-osprey-job-file.html#specifying-the-output-folder"><i class="fa fa-check"></i><b>4.4.6</b> Specifying the output folder</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="osprey-gui-tutorial.html"><a href="osprey-gui-tutorial.html"><i class="fa fa-check"></i><b>5</b> Osprey GUI tutorial</a>
<ul>
<li class="chapter" data-level="5.1" data-path="osprey-gui-tutorial.html"><a href="osprey-gui-tutorial.html#starting-osprey"><i class="fa fa-check"></i><b>5.1</b> Starting Osprey</a></li>
<li class="chapter" data-level="5.2" data-path="osprey-gui-tutorial.html"><a href="osprey-gui-tutorial.html#loading-a-job-file"><i class="fa fa-check"></i><b>5.2</b> Loading a job file</a></li>
<li class="chapter" data-level="5.3" data-path="osprey-gui-tutorial.html"><a href="osprey-gui-tutorial.html#loading-the-raw-mrs-data"><i class="fa fa-check"></i><b>5.3</b> Loading the raw MRS data</a></li>
<li class="chapter" data-level="5.4" data-path="osprey-gui-tutorial.html"><a href="osprey-gui-tutorial.html#processing-the-raw-data"><i class="fa fa-check"></i><b>5.4</b> Processing the raw data</a></li>
<li class="chapter" data-level="5.5" data-path="osprey-gui-tutorial.html"><a href="osprey-gui-tutorial.html#fitting-the-spectra"><i class="fa fa-check"></i><b>5.5</b> Fitting the spectra</a></li>
<li class="chapter" data-level="5.6" data-path="osprey-gui-tutorial.html"><a href="osprey-gui-tutorial.html#co-registering-to-an-anatomical-image"><i class="fa fa-check"></i><b>5.6</b> Co-registering to an anatomical image</a></li>
<li class="chapter" data-level="5.7" data-path="osprey-gui-tutorial.html"><a href="osprey-gui-tutorial.html#segmentation-and-tissue-fraction-calculation"><i class="fa fa-check"></i><b>5.7</b> Segmentation and tissue fraction calculation</a></li>
<li class="chapter" data-level="5.8" data-path="osprey-gui-tutorial.html"><a href="osprey-gui-tutorial.html#quantification"><i class="fa fa-check"></i><b>5.8</b> Quantification</a></li>
<li class="chapter" data-level="5.9" data-path="osprey-gui-tutorial.html"><a href="osprey-gui-tutorial.html#overview"><i class="fa fa-check"></i><b>5.9</b> Overview</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="osprey-command-line-tutorial.html"><a href="osprey-command-line-tutorial.html"><i class="fa fa-check"></i><b>6</b> Osprey command line tutorial</a></li>
<li class="chapter" data-level="7" data-path="osprey-basis-set-tools.html"><a href="osprey-basis-set-tools.html"><i class="fa fa-check"></i><b>7</b> Osprey basis set tools</a>
<ul>
<li class="chapter" data-level="7.1" data-path="osprey-basis-set-tools.html"><a href="osprey-basis-set-tools.html#io_lcmbasis"><i class="fa fa-check"></i><b>7.1</b> io_LCMBasis</a></li>
<li class="chapter" data-level="7.2" data-path="osprey-basis-set-tools.html"><a href="osprey-basis-set-tools.html#fit_makebasis"><i class="fa fa-check"></i><b>7.2</b> fit_makeBasis</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="osprey-basis-set-tools.html"><a href="osprey-basis-set-tools.html#complete-syntax"><i class="fa fa-check"></i><b>7.2.1</b> Complete syntax</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="osprey-basis-set-tools.html"><a href="osprey-basis-set-tools.html#fit_plotbasis"><i class="fa fa-check"></i><b>7.3</b> fit_plotBasis</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="osprey-basis-set-tools.html"><a href="osprey-basis-set-tools.html#complete-syntax-1"><i class="fa fa-check"></i><b>7.3.1</b> Complete syntax</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Osprey Documentation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="osprey-gui-tutorial" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Osprey GUI tutorial<a href="osprey-gui-tutorial.html#osprey-gui-tutorial" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This tutorial describes each step of the <strong>Osprey</strong> analysis workflow using the graphical user interface.</p>
<p>We will learn how to start the GUI, select the job file, load the raw data, process them into spectra, model the processed spectra, co-register the voxel to anatomical images, segment the anatomical images, and derive quantitative metabolite estimates.</p>

<div class="rmdnote">
In this documentation chapter, we will use the <code>jobTwix.m</code> job file in the <code>exampledata/twix/</code> directory of the <a href="https://github.com/schorschinho/osprey"><strong>Osprey</strong> repository</a>.
</div>
<div id="starting-osprey" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Starting Osprey<a href="osprey-gui-tutorial.html#starting-osprey" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>At the MATLAB prompt, enter</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode octave"><code class="sourceCode octave"><span id="cb1-1"><a href="osprey-gui-tutorial.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;</span> Osprey</span></code></pre></div>
<p>This will initiate the <strong>Osprey</strong> GUI application and the underlying processing modules. Once the startup is complete, you will see the <strong>Osprey</strong> startup menu box:</p>
<div class="figure"><span style="display:block;" id="fig:ospreyStartupMenu"></span>
<img src="img/04-osprey-startup-menu.png" alt="The Osprey Startup Menu." width="181" />
<p class="caption">
Figure 5.1: The Osprey Startup Menu.
</p>
</div>
</div>
<div id="loading-a-job-file" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Loading a job file<a href="osprey-gui-tutorial.html#loading-a-job-file" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Click the <code>Load Job file</code> button, navigate to the <code>exampledata/twix</code> directory, and add the file <code>jobTwix.m</code> to the right column:</p>
<div class="figure"><span style="display:block;" id="fig:ospreySelectJobFile"></span>
<img src="img/04-osprey-select-job-file.png" alt="Selecting a job file." width="510" />
<p class="caption">
Figure 5.2: Selecting a job file.
</p>
</div>
<p>Click <code>Done</code>. If you have run an <strong>Osprey</strong> analysis previously with the same output folder specified in the job file, you will be shown a warning:</p>
<div class="figure"><span style="display:block;" id="fig:ospreyOverwriteWarning"></span>
<img src="img/04-warning-overwrite.png" alt="Warning when you are about to overwrite a previous analysis." width="270" />
<p class="caption">
Figure 5.3: Warning when you are about to overwrite a previous analysis.
</p>
</div>
<p>Click <code>Yes</code>. <strong>Osprey</strong> will now extract all necessary information from the job file you selected by running the <code>OspreyJob</code> module in the background. The next window you see is the main GUI:</p>
<div class="figure"><span style="display:block;" id="fig:ospreyJob"></span>
<img src="img/04-osprey-gui-job.png" alt="The Osprey GUI after OspreyJob." width="742" />
<p class="caption">
Figure 5.4: The Osprey GUI after OspreyJob.
</p>
</div>
<p>In the bottom left corner, you see a list of datasets included in the job file definition.</p>

<div class="rmdnote">
All tabs and buttons (except <code>Load Data</code>, <code>Save MRSCont</code>, and <code>Exit</code>) are greyed out at this stage. They will become gradually available as we progress through the analysis workflow.
</div>
</div>
<div id="loading-the-raw-mrs-data" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Loading the raw MRS data<a href="osprey-gui-tutorial.html#loading-the-raw-mrs-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Click the <code>Load data</code> button to initiate the loading process of the raw MRS data. <strong>Osprey</strong> will now extract the raw FIDs and header data (and perform coil combination, if applicable) by running the <code>OspreyLoad</code> module in the background. For larger files (with separate FIDs for each coil), this process may take a few seconds per dataset. You can monitor the progress through the wait bar.</p>
<p>Once the loading process is complete, you can see the coil-combined, but un-aligned and un-averaged data. You can select the dataset you wish to be displayed by clicking on the entry in the dataset list in the bottom left corner, and you can easily scroll through the different datasets using the <kbd>⬆</kbd> and <kbd>⬇</kbd> keys on your keyboard.</p>
<table>
<tr>
<th style="text-align:center">
First dataset
</th>
<th style="text-align:center">
Second dataset
</th>
</tr>
<tr>
<td halign="center">
<img src="img/04-load-mets-1.png">
</td>
<td halign="center">
<img src="img/04-load-mets-2.png">
</td>
</tr>
</table>
<p>By clicking the <code>metabolites</code>, <code>reference</code> and <code>water</code> tabs at the bottom of the window, you can display the water-suppressed, lineshape reference, and short-TE water data (if applicable):</p>
<table>
<tr>
<th style="text-align:center">
Metabolite data
</th>
<th style="text-align:center">
Lineshape reference data
</th>
<th style="text-align:center">
Short-TE water data
</th>
</tr>
<tr>
<td halign="center">
<img src="img/04-load-mets-1.png">
</td>
<td halign="center">
<img src="img/04-load-ref-1.png">
</td>
<td halign="center">
<img src="img/04-load-w-1.png">
</td>
</tr>
</table>

<div class="rmdnote">
In the box above the spectrum display, you will find useful information about the sequence, such as TR/TE, number of averages, voxel dimensions, etc.
</div>

<div class="rmdnote">
You can export a PDF of the spectrum (along with the information box) by clicking on the <code>Save PDF</code> button in the top right corner of the window.
</div>
</div>
<div id="processing-the-raw-data" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Processing the raw data<a href="osprey-gui-tutorial.html#processing-the-raw-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Click the (now available!) <code>Process data</code> button to initiate the post-processing. <strong>Osprey</strong> will now perform all appropriate processing steps (depending on the available data: eddy-current correction, frequency-and-phase alignment, water removal, frequency referencing, initial phasing) by running the <code>OspreyProcess</code> module in the background. This process may take several seconds per dataset. You can monitor the progress through the wait bar.</p>
<p>Once the post-processing is complete, the <code>Processed</code> tab becomes active, showing four different panels:</p>
<div class="figure"><span style="display:block;" id="fig:ospreyProcess"></span>
<img src="img/04-process-mets.png" alt="The Osprey GUI after OspreyProcess." width="694" />
<p class="caption">
Figure 5.5: The Osprey GUI after OspreyProcess.
</p>
</div>
<p>The top left panel shows the individual averages prior to frequency-and-phase alignment. The bottom left panel shows them after frequency-and-phase alignment.
The top right panel shows a scatter plot of the maximum of the 3.02 ppm Cr/PCr signal over the course of the acquisition for both pre- and post-alignment. Finally, the bottom right panel shows the aligned, averaged and referenced spectrum after eddy-current correction and residual water removal. This spectrum will be passed on to the <code>Fit</code> module for modeling.</p>
<div class="figure"><span style="display:block;" id="fig:ospreyProcess2"></span>
<img src="img/04-process-mets-subspec.png" alt="Different sub-spectra can be visualized by cycling through the &quot;Spec&quot; windows." width="672" />
<p class="caption">
Figure 5.6: Different sub-spectra can be visualized by cycling through the “Spec” windows.
</p>
</div>
<p>Individual sub-spectra, and combinations thereof, can be visualized by cycling through the “spec” arrows at the top left of the screen.</p>

<div class="rmdnote">
You can go back to inspecting the raw data by clicking the <code>Raw</code> tab at the top of the window.
</div>
<p>Again, you can display each dataset by selecting it from the dataset list in the bottom left corner, and you can look at the water reference data by clicking on the tabs at the bottom of the window.</p>

<div class="rmdnote">
In the box above the spectrum display, you will find some data quality metrics, such as the signal-to-noise ratio (SNR), linewidth (FWHM), and average frequency drift pre- and post-alignment.
</div>

<div class="rmdnote">
You can export a PDF of the four post-processing display panels (along with the information box) by clicking on the <code>Save PDF</code> button in the top right corner of the window.
</div>
</div>
<div id="fitting-the-spectra" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Fitting the spectra<a href="osprey-gui-tutorial.html#fitting-the-spectra" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Click the (now available!) <code>Fit data</code> button to initiate the post-processing. <strong>Osprey</strong> will now model the processed metabolite and water spectra by running the <code>OspreyFit</code> module in the background. This process may take a few seconds, or up to a minute or more per dataset, depending on the complexity of the data and model. You can monitor the progress through the wait bar.</p>
<p>Once the modeling is complete, the <code>Fit</code> tab becomes active:</p>
<div class="figure"><span style="display:block;" id="fig:ospreyFit"></span>
<img src="img/04-fit-mets.png" alt="The Osprey GUI after OspreyFit." width="694" />
<p class="caption">
Figure 5.7: The Osprey GUI after OspreyFit.
</p>
</div>
<p>The <code>Fit</code> tab displays the complete fit overlaid on top of the data, along with the smooth cubic B-spline baseline, and the fit residual at the top.
Below, the contributions from each basis functions are plotted, with the estimated lineshape convolution, linebroadening and frequency shift parameters applied. For better display, the phase parameters have been applied to the spectrum, so that the basis functions appear without phase.
The left panel shows the raw water-scaled metabolite estimates, i.e. the signal amplitudes normalized by the water amplitude. The amplitude parameters will subsequently be used during the quantification process to derive tCr ratios and water-scaled estimates.</p>

<div class="rmdnote">
You can go back to the previous analysis steps by clicking the <code>Raw</code> or <code>Processed</code> tabs at the top of the window.
</div>
<p>Again, you can display each dataset by selecting it from the dataset list in the bottom left corner, and you can look at the water reference data fits by clicking on the tabs at the bottom of the window.</p>

<div class="rmdnote">
In the box above the spectrum display, you will find fit parameters and information, such as the number of basis functions used, phase estimates, and scaling factors.
</div>

<div class="rmdnote">
You can export a PDF of the fit (along with the information box) by clicking on the <code>Save PDF</code> button in the top right corner of the window.
</div>
</div>
<div id="co-registering-to-an-anatomical-image" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Co-registering to an anatomical image<a href="osprey-gui-tutorial.html#co-registering-to-an-anatomical-image" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Click the <code>CoRegister</code> button to initiate the SPM routines for co-registering a voxel to a T1-weighted anatomical image. <strong>Osprey</strong> will now parse the voxel geometry information and create the voxel mask by running the <code>OspreyCoReg</code> module in the background. This process will take a few seconds per dataset. You can monitor the progress through the wait bar.</p>

<div class="rmdnote">
If you are only interested in the voxel mask, you can skip the <code>Process</code> and <code>Fit</code> steps of the analysis. The <code>CoRegister</code> button becomes available after the <code>Load data</code> analysis step has been completed.
</div>
<p>Once the co-registration is complete, the <code>Cor/Seg</code> tab becomes active:</p>
<div class="figure"><span style="display:block;" id="fig:ospreyCoreg"></span>
<img src="img/04-coreg.png" alt="The Osprey GUI after OspreyCoReg." width="645" />
<p class="caption">
Figure 5.8: The Osprey GUI after OspreyCoReg.
</p>
</div>
<p>You can see an overlay of the voxel mask on top of the anatomical image in three directions.</p>

<div class="rmdnote">
You can export a PDF of the co-registration display by clicking on the <code>Save PDF</code> button in the top right corner of the window.
</div>

<div class="rmdnote">
The <code>Nii Viewer</code> button in the top left corner of the window opens the current paricipant’s structural image in an external NIfTI viewer for closer inspection.
</div>
</div>
<div id="segmentation-and-tissue-fraction-calculation" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Segmentation and tissue fraction calculation<a href="osprey-gui-tutorial.html#segmentation-and-tissue-fraction-calculation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Click the <code>Segment</code> button to initiate the determination of the tissue volume fractions for the co-registered voxel. <strong>Osprey</strong> will now call the SPM12 segmentation functions and calculate the fractions of grey matter, white matter, and cerebrospinal fluid by running the <code>OspreySeg</code> module in the background. If you have previously segmented the images, this step will only take a few seconds. However, if <strong>Osprey</strong> has to initiate the segmentation first, it can take up to several minutes per dataset. You can monitor the progress through the wait bar.</p>

<div class="rmdnote">
If you are only interested in the tissue fractions, you can skip the <code>Process</code> and <code>Fit</code> steps of the analysis. The <code>Segment</code> button becomes available after the <code>Load data</code> and <code>CoRegister</code> analysis steps have been completed.
</div>
<p>Once the segmentation is complete, the <code>Cor/Seg</code> tab features another figure:</p>
<div class="figure"><span style="display:block;" id="fig:ospreySeg"></span>
<img src="img/04-seg.png" alt="The Osprey GUI after OspreySeg." width="645" />
<p class="caption">
Figure 5.9: The Osprey GUI after OspreySeg.
</p>
</div>
<p>Below the overlay produced by <code>CoRegister</code>, you can now see four images showing the voxel mask next to the contributions from grey matter, white matter, and CSF, along with the fractional volume estimates for each tissue class. These values will subsequently be used during quantification to account for tissue-specific effects of relaxation, tissue water content, and metabolite content.</p>

<div class="rmdnote">
You can export a PDF of the combined co-registration/segmentation display by clicking on the <code>Save PDF</code> button in the top right corner of the window.
</div>
</div>
<div id="quantification" class="section level2 hasAnchor" number="5.8">
<h2><span class="header-section-number">5.8</span> Quantification<a href="osprey-gui-tutorial.html#quantification" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Click the <code>Quantify</code> button to have <strong>Osprey</strong> run the <code>OspreyQuantify</code> module in the background. This should take less than a second per dataset. During this process, several quantitative metabolite estimates are calculated, such as tCr ratios and water-scaled estimates with different degrees of sophistication. Please refer to the <strong>Osprey</strong> manuscript for details on the implementation of these quantification routines.</p>
<p>Once the quantification is complete, the <code>Quantify</code> tab becomes active:</p>
<div class="figure"><span style="display:block;" id="fig:ospreyQuantify"></span>
<img src="img/04-quantify.png" alt="The Osprey GUI after OspreyQuantify." width="645" />
<p class="caption">
Figure 5.10: The Osprey GUI after OspreyQuantify.
</p>
</div>
<p>This tab contains a bare-bone table of the quantitative results for each basis function and each quantification routine for the selected dataset. These numbers are saved in <code>.CSV</code> format tables in the <code>QuantifyResults</code> sub-directory of the output folder.</p>
<p>At this stage, all analysis steps have been completed. You can save the current state of the analysis by exporting it the <strong>Osprey</strong> data container as a <code>.mat</code> file using the <code>Save MRSCont</code> button. You can re-load it at any time using the <code>Load MRSCont file</code> button in the Osprey startup menu (see Step 1 of this tutorial).</p>
</div>
<div id="overview" class="section level2 hasAnchor" number="5.9">
<h2><span class="header-section-number">5.9</span> Overview<a href="osprey-gui-tutorial.html#overview" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>After quantification is complete, another tab becomes active: <code>Overview</code>. This tab contains several visualizations that are interesting for the batched analysis of multiple datasets.</p>
<p>By clicking on the tabs at the bottom of the window, you can cycle through the following visualizations:</p>
<ul>
<li><strong>Spectra</strong>: Displays all processed spectra (or fits) on top of each other in a single plot.</li>
</ul>

<div class="rmdnote">
You can select the data or complete fits for the metabolite and water data by using the dropdown menu at the top of the window.
</div>
<div class="figure"><span style="display:block;" id="fig:ospreyOverviewSpectra"></span>
<img src="img/04-overview-spectra.png" alt="The Overview Spectra tab in the Osprey GUI." width="645" />
<p class="caption">
Figure 5.11: The Overview Spectra tab in the Osprey GUI.
</p>
</div>
<ul>
<li><strong>Mean spectra</strong>: Displays the mean of spectra (or fits) across all datasets, along with the mean baseline, mean residual, and a ribbon plot representing the standard deviation across all spectra.</li>
</ul>

<div class="rmdnote">
You can select the metabolite and water data by using the dropdown menu at the top of the window.
</div>
<div class="figure"><span style="display:block;" id="fig:ospreyOverviewMeanSpectra"></span>
<img src="img/04-overview-mean-spectra.png" alt="The Overview Mean Spectra tab in the Osprey GUI." width="645" />
<p class="caption">
Figure 5.12: The Overview Mean Spectra tab in the Osprey GUI.
</p>
</div>
<ul>
<li><strong>Mean spectra</strong>: Displays the mean of spectra (or fits) across all datasets, along with the mean baseline, mean residual, and a ribbon plot representing the standard deviation across all spectra.</li>
</ul>

<div class="rmdnote">
You can select the metabolite and water data by using the dropdown menu at the top of the window.
</div>
<ul>
<li><strong>Quantify table</strong>: Shows a table with the results of a specific quantification routine for all metabolites and all datasets.</li>
</ul>

<div class="rmdnote">
You can select the quantification routine to be displayed (tCr ratios, raw water-scaled, CSF-corrected water-scaled, tissue-corrected water-scaled) by using the dropdown menu at the top of the window.
</div>
<div class="figure"><span style="display:block;" id="fig:ospreyQuantifyTable"></span>
<img src="img/04-overview-quantify-table.png" alt="The Overview Quantify Table tab in the Osprey GUI." width="645" />
<p class="caption">
Figure 5.13: The Overview Quantify Table tab in the Osprey GUI.
</p>
</div>
<ul>
<li><strong>Distribution</strong>: Shows a raincloud plot of the results of a specific quantification routine for a specific metabolite. The raincloud plot includes a visualization of the distribution, the mean and median values of the distribution, standard deviation, and 25% and 75% percentiles. In addition, each data point is shown.</li>
</ul>

<div class="rmdnote">
You can select the quantification routine to be displayed (tCr ratios, raw water-scaled, CSF-corrected water-scaled, tissue-corrected water-scaled), as well as the particular metabolite you want to study.
</div>
<p>By default, the <code>Distribution</code> tab is set to display the tCr ratios of tNAA.</p>
<div class="figure"><span style="display:block;" id="fig:ospreyOverviewDistribution"></span>
<img src="img/04-overview-distribution.png" alt="The Overview Distribution tab in the Osprey GUI." width="645" />
<p class="caption">
Figure 5.14: The Overview Distribution tab in the Osprey GUI.
</p>
</div>
<ul>
<li><strong>Correlation</strong>: Shows a highly customizable 2D scatter plot of a quantitative metabolite estimate against another quantitative metabolite estimate, or a quality metric. <strong>Osprey</strong> automatically calculates the Pearson correlation coefficient and a p-value (uncorrected for multiple comparisons), and plots the linear regression line with shaded confidence intervals.</li>
</ul>

<div class="rmdnote">
You can select the quantification routine and metabolite to be correlated, as well as another metabolite or quality metric that it is to be correlated against, by using the dropdown menus at the top of the window.
</div>
<p>By default, the <code>Correlation</code> tab is set to display the correlation of tNAA/tCr to SNR.</p>
<div class="figure"><span style="display:block;" id="fig:ospreyOverviewCorrelation"></span>
<img src="img/04-overview-correlation.png" alt="The Overview Correlation tab in the Osprey GUI." width="645" />
<p class="caption">
Figure 5.15: The Overview Correlation tab in the Osprey GUI.
</p>
</div>

<div class="rmdnote">
<p>We are incredibly grateful for the fantastic <a href="https://github.com/RainCloudPlots/RainCloudPlots">raincloud plot tools</a> developed by Micah Allen, Davide Poggiali, Kirstie Whitaker, Tom Rhys Marshall, and Rogier Kievit. Should you make use of the OspreyOverview raincloud plots, please consider citing their original publications:</p>
<pre><code>&gt;    * Allen M, Poggiali D, Whitaker K et al. Raincloud plots: a multi-platform tool for robust data
&gt; visualization [version 1; peer review: 2 approved].
&gt; Wellcome Open Res 2019, 4:63. DOI: 10.12688/wellcomeopenres.15191.1
&gt;    * Allen M, Poggiali D, Whitaker K, Marshall TR, Kievit R. (2018) RainCloudPlots tutorials and codebase (Version v1.1). Zenodo. http://doi.org/10.5281/zenodo.3368186</code></pre>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-osprey-job-file.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="osprey-command-line-tutorial.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/schorschinho/osprey/edit/master/04-tutorial.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
